const Utils = require('./utils.js');
const _utils = new Utils();

class Rest {
    /**
     * Funtion to make rest calls using fetch api
     * @param {string} url    # url to make a call
     * @param {json} data   # object with method type and payload
     * @param {function} success # success callback for the url
     * @param {function} fail   # fail callback for the url
     */
    data(url, data, success, fail) {
        fetch(url, data)
            .then(res => res.text().then(data => ({ status: res.status, body: data })))
            .then(response => {
                let data = (_utils.isJsonString(response.body)) ? JSON.parse(response.body) : response.body;
                (response.status < 400) ? success(data) : fail(data);
            })
            .catch((err) => {
                fail(err);
            });
    }
}
module.exports = Rest